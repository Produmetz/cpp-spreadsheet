# C++ Spreadsheet

Реализация электронной таблицы с поддержкой формул на C++ с использованием ANTLR для парсинга.

## Функциональность

- Поддержка ячеек с текстом, числами и формулами
- Вычисления формул с операторами (+,-,*,/) и скобками
- Поддержка ссылок на другие ячейки (A1, B2, и т.д.)
- Обнаружение циклических зависимостей
- Кэширование результатов вычислений для производительности
- Печать таблицы в виде текста или вычисленных значений
- Комплексная система тестирования

## Технологии

- **C++17** с использованием современных возможностей (std::variant, std::optional и др.)
- **ANTLR 4.13.2** для парсинга формул
- **CMake** для сборки
- **STL** контейнеры и алгоритмы

## Сборка и запуск

```bash
# Клонирование репозитория
git clone <repository-url>
cd cpp-spreadsheet

# Создание директории для сборки
mkdir build
cd build

# Генерация Makefile
cmake ../spreadsheet

# Компиляция проекта
make

# Запуск приложения с тестами
./spreadsheet
```

## Использование

Проект представляет собой библиотеку для работы с электронными таблицами. Основные возможности:

```cpp
// Создание таблицы
auto sheet = CreateSheet();

// Установка значений ячеек
sheet->SetCell("A1"_pos, "42");              // Число
sheet->SetCell("B1"_pos, "Hello");           // Текст
sheet->SetCell("C1"_pos, "=A1*2");           // Формула

// Получение значений
auto value = sheet->GetCell("C1"_pos)->GetValue(); // Вернет 84.0

// Печать таблицы
sheet->PrintValues(std::cout);  // Вывод вычисленных значений
sheet->PrintTexts(std::cout);   // Вывод исходных текстов
```

## Ценность проекта

Данный проект демонстрирует:
- Работу со сложными зависимостями между объектами
- Использование внешних парсеров (ANTLR) в C++ проектах
- Реализацию кэширования для оптимизации производительности
- Обработку ошибок и исключительных ситуаций
- Современные практики C++ программирования
- Комплексное тестирование функциональности

## Структура проекта

```
spreadsheet/
├── CMakeLists.txt              # Конфигурация сборки CMake
├── FindANTLR.cmake             # Поиск ANTLR для CMake
├── README.md                   # Документация
├── antlr-4.13.2-complete.jar   # Библиотека ANTLR
├── antlr4_runtime/             # Runtime для ANTLR
├── cell.h & cell.cpp           # Реализация ячеек
├── common.h                    # Общие структуры данных
├── formula.h & formula.cpp     # Интерфейс формул
├── Formula.g4                  # Грамматика формул для ANTLR
├── FormulaAST.h & FormulaAST.cpp # AST для формул
├── main.cpp                    # Точка входа и тесты
├── sheet.h & sheet.cpp         # Реализация таблицы
├── structures.cpp              # Вспомогательные структуры
└── test_runner_p.h             # Фреймворк для тестирования
```




Этот проект представляет собой полноценную реализацию электронной таблицы с поддержкой формул, демонстрируя продвинутые техники программирования на C++ и интеграцию с инструментами парсинга.
